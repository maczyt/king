<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>King æºç åˆ†æ | Kingæºç è§£æ</title>
    <meta name="description" content="ç±»Vueæ¡†æ¶çš„ä»0åˆ°1">
    
    
    <link rel="preload" href="/king/assets/css/styles.d4027d0f.css" as="style"><link rel="preload" href="/king/assets/js/app.d4027d0f.js" as="script"><link rel="preload" href="/king/assets/js/7.b21380cc.js" as="script"><link rel="prefetch" href="/king/assets/css/1.styles.1ff0108a.css"><link rel="prefetch" href="/king/assets/css/3.styles.80dafa89.css"><link rel="prefetch" href="/king/assets/js/1.1ff0108a.js"><link rel="prefetch" href="/king/assets/js/2.ac19b70c.js"><link rel="prefetch" href="/king/assets/js/3.80dafa89.js"><link rel="prefetch" href="/king/assets/js/4.e1e475c9.js"><link rel="prefetch" href="/king/assets/js/5.4d114b2a.js"><link rel="prefetch" href="/king/assets/js/6.b3f47081.js">
    <link rel="stylesheet" href="/king/assets/css/1.styles.1ff0108a.css"><link rel="stylesheet" href="/king/assets/css/3.styles.80dafa89.css"><link rel="stylesheet" href="/king/assets/css/styles.d4027d0f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/king/" class="home-link router-link-active"><!----> <span class="site-name">Kingæºç è§£æ</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com//maczyt/king" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"> <a href="https://github.com//maczyt/king" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span>Guide</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/king/intro.html" class="active sidebar-link">æ¡†æ¶ä»‹ç»</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/king/intro.html#è®²è§£é£æ ¼" class="sidebar-link">è®²è§£é£æ ¼</a></li><li class="sidebar-sub-header"><a href="/king/intro.html#è¦å®ç°çš„ä»£ç " class="sidebar-link">è¦å®ç°çš„ä»£ç </a></li></ul></li><li><a href="/king/data.html" class="sidebar-link">dataå¤„ç†</a></li><li><a href="/king/compile.html" class="sidebar-link">htmlå¤„ç†</a></li><li><a href="/king/computed.html" class="sidebar-link">computedå¤„ç†</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="king-æºç åˆ†æ"><a href="#king-æºç åˆ†æ" aria-hidden="true" class="header-anchor">#</a> King æºç åˆ†æ</h1> <blockquote><p>æ¥å¤§åå·²æœ‰ 10 ä¸ªæœˆä¹‹ä½™ï¼Œæ¥ä¹‹åä¸€ç›´ä½¿ç”¨<code>vue.js</code>å…¨å®¶æ¡¶å¹²æ´»ï¼Œå¯¹äºå¹³å¸¸å‡ºç°çš„ bug åŸºæœ¬å·²è¾¾åˆ°äº† 90%å¯ä»¥å¾ˆå¿«è§£å†³ï¼ŒåŠ ä¸Šç»„é‡ŒåŒäº‹çš„æ§åœº(<strong>æ¶›ç¥</strong>)ï¼Œä¸ªäººè™šè£å¿ƒå¾—åˆ°å¾ˆå¤§çš„æ»¡è¶³ï¼Œä½†æ˜¯æˆ‘çŸ¥é“è‡ªå·±è¿˜æœ‰å¾ˆå¤šçš„ä¸è¶³ï¼Œç§‰ç€è€ƒå¯Ÿè‡ªå·±å¯¹<code>vue.js</code>çš„æŒæ¡+ä¸ºç»„é‡Œå°ä¼™ä¼´é€ç‚¹ç¦åˆ©çš„ï¼Œå‡†å¤‡äº†æœ¬æ¬¡åˆ†äº«ï¼Œå¸Œæœ›åœ¨åœºçš„èƒ½æœ‰æ‰€æ”¶è·(æ²¡æ¥çš„å°±å˜¿å˜¿å˜¿äº† ğŸ˜•)</p></blockquote> <div class="tip custom-block"><p class="custom-block-title">éœ€è¦æå‰å‡†å¤‡çš„çŸ¥è¯†ç‚¹</p> <ol><li><code>Object.defineProperty</code> (Vue3 ä½¿ç”¨ ES6 çš„ Proxy é‡å†™)</li> <li>DOM èŠ‚ç‚¹çš„ç›¸å…³çŸ¥è¯†: nodeTypeã€tagNameã€attributesã€childNodes æ–‡æœ¬èŠ‚ç‚¹ã€å…ƒç´ èŠ‚ç‚¹ã€æ³¨é‡ŠèŠ‚ç‚¹</li> <li>è®¾è®¡æ¨¡å¼
<ul><li>å‘å¸ƒè®¢é˜…è€…(è§‚å¯Ÿè€…)</li> <li>ä»£ç†</li></ul></li></ol></div> <h2 id="è®²è§£é£æ ¼"><a href="#è®²è§£é£æ ¼" aria-hidden="true" class="header-anchor">#</a> è®²è§£é£æ ¼</h2> <div class="warning custom-block"><p class="custom-block-title">èƒŒæ™¯(ç°çŠ¶)</p> <p>ç›®å‰å¸‚é¢ä¸Šå·²æœ‰å¾ˆå¤šå…³äºè®²è§£ Vue.js æºç çš„æ–‡ç« å’Œæ•™ç¨‹ï¼Œç›¸ä¿¡çœ‹è¿‡çš„ï¼Œéƒ½ä¼šçŸ¥é“æ•°æ®çš„åŒå‘ç»‘å®šåŸç†ï¼Œä½†ç»å¸¸åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œæƒ³çŸ¥é“æ›´å¤šå°±æ²¡äº†~</p> <p>æˆ–è€…å¯¹æ¯ä¸ªçŸ¥è¯†éƒ½è®²ä¸€ç‚¹ï¼Œè¿™æ ·åˆæ²¡æ³•è¿èµ·æ¥ï¼Œå¯¼è‡´æˆ‘ä»¬æ— æ³•çœ‹åˆ°å®ç°çš„ä¾‹å­ï¼Œä»è€Œè¿·å¤±åœ¨â€œæµ©ç€šâ€çš„ä»£ç ä¸­ï¼Œé€‰æ‹©æ”¾å¼ƒã€‚</p></div> <div class="tip custom-block"><p class="custom-block-title">æˆ‘çš„æ–¹å¼</p> <p>æˆ‘å°†æŒ‰ç€æ„é€ å‡½æ•°ä¸€æ­¥ä¸€æ­¥è®²è§£ï¼Œç…§ç€è®²è§£ç¼–å†™å‡ºå±äºæˆ‘ä»¬çš„<code>MVVM</code>æ¡†æ¶ã€‚å½“ç„¶æ˜¯é˜‰å‰²ç‰ˆçš„ï¼Œæ¯•ç«Ÿå®Œæ•´ç‰ˆæˆ‘ä¹Ÿä¸ä¼š ğŸ˜„</p></div> <h2 id="è¦å®ç°çš„ä»£ç "><a href="#è¦å®ç°çš„ä»£ç " aria-hidden="true" class="header-anchor">#</a> è¦å®ç°çš„ä»£ç </h2> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">k-text</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">k-text</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>age<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">k-text</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>user<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">King</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  el<span class="token punctuation">:</span> <span class="token string">&quot;.app&quot;</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      name<span class="token punctuation">:</span> <span class="token string">&quot;zyt&quot;</span><span class="token punctuation">,</span>
      age<span class="token punctuation">:</span> <span class="token number">25</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token template-string"><span class="token string">`My name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, age is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å½“æˆ‘ä»¬è°ƒç”¨<code>new King()</code>ï¼ŒKing ä¼š:</p> <ol><li>åˆå§‹å®ä¾‹çŠ¶æ€</li> <li>ç¼–è¯‘ htmlï¼Œè§£ææŒ‡ä»¤</li></ol> <table><thead><tr><th style="text-align:center">åˆå§‹çŠ¶æ€</th> <th style="text-align:center">ç¼–è¯‘ html</th></tr></thead> <tbody><tr><td style="text-align:center"><s>props: çˆ¶å­ç»„ä»¶ prop</s></td> <td style="text-align:center">æ·±åº¦ä¼˜å…ˆéå† DOMï¼Œè¯†åˆ«æŒ‡ä»¤æˆ–è€…<code>{{}}</code>æ¸²æŸ“çš„æ–‡æœ¬</td></tr> <tr><td style="text-align:center">data</td> <td style="text-align:center"></td></tr> <tr><td style="text-align:center">computed</td> <td style="text-align:center"></td></tr></tbody></table> <p>ç”±äºä¸æ‰“ç®—è®²è§£çˆ¶å­ç»„ä»¶ï¼Œæ‰€ä»¥æŠŠ props ç•¥è¿‡ï¼Œè®©æˆ‘ä»¬ä» data å¼€å§‹å§ï¼Œå…ˆå¤§è‡´çœ‹ä¸‹<code>Schema</code></p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">/* Obserber start */</span>

<span class="token keyword">interface</span> <span class="token class-name">ObserverIF</span> <span class="token punctuation">{</span>
  value<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  dep<span class="token punctuation">:</span> DepIF<span class="token punctuation">;</span>
  <span class="token comment">// observer obj</span>
  <span class="token function">walk</span><span class="token punctuation">(</span>obj<span class="token punctuation">:</span> object<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// observer obj key</span>
  <span class="token function">convert</span><span class="token punctuation">(</span>obj<span class="token punctuation">:</span> object<span class="token punctuation">,</span> key<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* Obserber end */</span>

<span class="token comment">/* Dep start */</span>
<span class="token comment">// å‘å¸ƒè€…</span>
<span class="token keyword">interface</span> <span class="token class-name">DepIF</span> <span class="token punctuation">{</span>
  subs<span class="token punctuation">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>WatcherIF<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token comment">// æ·»åŠ è®¢é˜…è€…</span>
  <span class="token function">addSub</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// åˆ é™¤è®¢é˜…è€…</span>
  <span class="token function">removeSub</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// å‘Šè¯‰å½“å‰è®¢é˜…è€…å¯ä»¥æŠŠæˆ‘æ·»åŠ åˆ°ä½ è®¢é˜…çš„åˆ—è¡¨ä¸­</span>
  <span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// é€šçŸ¥è®¢é˜…è€…æ›´æ–°å§</span>
  <span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* Dep end */</span>

<span class="token comment">/* Watcher start */</span>
<span class="token comment">// è®¢é˜…è€…</span>
<span class="token keyword">interface</span> <span class="token class-name">WatcherIF</span> <span class="token punctuation">{</span>
  <span class="token comment">// ç»‘å®šçš„expressionå€¼</span>
  value<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  expOrFn<span class="token punctuation">:</span> <span class="token builtin">Function</span> <span class="token operator">|</span> String<span class="token punctuation">;</span>
  vm<span class="token punctuation">:</span> KingIF<span class="token punctuation">;</span>
  <span class="token comment">// æŒ‡ä»¤ç»‘å®šçš„å›è°ƒå‡½æ•°</span>
  cb<span class="token punctuation">:</span> <span class="token builtin">Function</span><span class="token punctuation">;</span>
  deps<span class="token punctuation">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>DepIF<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token comment">// è®¢é˜…è€…æ›´æ–°</span>
  <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// æ·»åŠ å‘å¸ƒè€…</span>
  <span class="token function">addDep</span><span class="token punctuation">(</span>dep<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">beforeGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">afterGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">set</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* Watcher end */</span>

<span class="token comment">/* Directive start */</span>
<span class="token comment">// æŒ‡ä»¤</span>
<span class="token keyword">interface</span> <span class="token class-name">DirectiveIF</span> <span class="token punctuation">{</span>
  vm<span class="token punctuation">:</span> KingIF<span class="token punctuation">;</span>
  el<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  name<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  _watcher<span class="token punctuation">:</span> WatcherIF<span class="token punctuation">;</span>
  <span class="token function">_bind</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// _update(val, oldVal);</span>
<span class="token punctuation">}</span>
<span class="token comment">/* Directive end */</span>

<span class="token comment">/* King start */</span>
<span class="token keyword">interface</span> <span class="token class-name">KingIF</span> <span class="token punctuation">{</span>
  id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  el<span class="token punctuation">:</span> Node<span class="token punctuation">;</span>
  <span class="token comment">/* å†…éƒ¨å±æ€§ start */</span>
  _data<span class="token punctuation">:</span> object<span class="token punctuation">;</span>
  <span class="token comment">// æ”¶é›†å½“å‰ç»„ä»¶watcher</span>
  _watchers<span class="token punctuation">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>WatcherIF<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token comment">// æ”¶é›†å½“å‰ç»„ä»¶directive</span>
  _directives<span class="token punctuation">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>DirectiveIF<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token comment">/* å†…éƒ¨å±æ€§ end */</span>

  <span class="token comment">/* å…¬å…±å±æ€§ start */</span>
  $options<span class="token punctuation">:</span> object<span class="token punctuation">;</span>
  <span class="token comment">/* å…¬å…±å±æ€§ end */</span>
<span class="token punctuation">}</span>
<span class="token comment">/* King end */</span>
</code></pre></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com//maczyt/king/edit/master/intro.md" target="_blank" rel="noopener noreferrer">åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/king/data.html">
          dataå¤„ç†
        </a>
        â†’
      </span></p></div> </div> <!----></div></div>
    <script src="/king/assets/js/7.b21380cc.js" defer></script><script src="/king/assets/js/app.d4027d0f.js" defer></script>
  </body>
</html>
